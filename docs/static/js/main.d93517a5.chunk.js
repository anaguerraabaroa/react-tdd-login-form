(this["webpackJsonpreact-tdd-login-form"]=this["webpackJsonpreact-tdd-login-form"]||[]).push([[0],{81:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(10),c=a.n(s),i=a(28),o=a(13),l=a(43),u=a(49),j=a(50),d=a.n(j),b=a(57),h=a(22),m=a(130),p=a(131),O=a(127),x=a(133),f=a(125),v=a(123),g=a(134),w=a(58),y=a.n(w),S=a(126),C=a(120),A=function(e){var t=e.email,a=e.password;return fetch("/login",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({email:t,password:a})})},T="admin",k="employee",P=r.a.createContext(),N=function(e){return/^([A-Za-z0-9_\-.])+@([A-Za-z0-9_\-.])+\.([A-Za-z]{2,4})$/.test(e)},R=function(e){return/^(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})/.test(e)},q=a(5),z=Object(C.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),D=function(){var e=z(),t=Object(n.useContext)(P),a=t.handleSuccessLogin,r=t.user,s=Object(n.useState)(""),c=Object(h.a)(s,2),i=c[0],j=c[1],w=Object(n.useState)(""),C=Object(h.a)(w,2),D=C[0],E=C[1],W=Object(n.useState)({email:"",password:""}),Z=Object(h.a)(W,2),B=Z[0],J=Z[1],L=Object(n.useState)(!1),I=Object(h.a)(L,2),$=I[0],_=I[1],H=Object(n.useState)(!1),M=Object(h.a)(H,2),F=M[0],G=M[1],K=Object(n.useState)(""),Q=Object(h.a)(K,2),U=Q[0],V=Q[1],X=function(){var e=!B.email,t=!B.password;return e&&j("The email is required"),t&&E("The password is required"),e||t},Y=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,s,c,i,o,l,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!X()){e.next=3;break}return e.abrupt("return");case 3:return n=B.email,r=B.password,e.prev=4,_(!0),e.next=8,A({email:n,password:r});case 8:if((s=e.sent).ok){e.next=11;break}throw s;case 11:return e.next=13,s.json();case 13:c=e.sent,i=c.user,o=i.role,l=i.username,a({role:o,username:l}),e.next=27;break;case 20:return e.prev=20,e.t0=e.catch(4),e.next=24,e.t0.json();case 24:u=e.sent,V(u.message),G(!0);case 27:return e.prev=27,_(!1),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[4,20,27,30]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(e){var t=e.target,a=t.value,n=t.name;J(Object(u.a)(Object(u.a)({},B),{},Object(l.a)({},n,a)))};return $||r.role!==T?$||r.role!==k?Object(q.jsxs)(v.a,{component:"main",maxWidth:"xs",children:[Object(q.jsx)(f.a,{}),Object(q.jsxs)("div",{className:e.paper,children:[Object(q.jsx)(g.a,{className:e.avatar,children:Object(q.jsx)(y.a,{})}),Object(q.jsx)(S.a,{component:"h1",variant:"h5",children:"Login Page"}),$&&Object(q.jsx)(O.a,{"data-testid":"loading-indicator"}),Object(q.jsxs)("form",{className:e.form,onSubmit:Y,children:[Object(q.jsx)(m.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"email",id:"email",name:"email",helperText:i,onChange:ee,onBlur:function(){N(B.email)?j(""):j("The email is invalid. Example: john.doe@mail.com")},value:B.email,error:!!i}),Object(q.jsx)(m.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"password",id:"password",type:"password",name:"password",helperText:D,onChange:ee,onBlur:function(){R(B.password)?E(""):E("The password must contain at least 8 characters, one upper case letter, one number and one special character")},value:B.password,error:!!D}),Object(q.jsx)(p.a,{type:"submit",disabled:$,fullWidth:!0,variant:"contained",color:"primary",className:e.submit,children:"Send"})]}),Object(q.jsx)(x.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:F,autoHideDuration:6e3,onClose:function(){G(!1)},message:U})]})]}):Object(q.jsx)(o.a,{to:"/employee"}):Object(q.jsx)(o.a,{to:"/admin"})},E=function(e){var t=e.children,a=e.path,r=e.allowRoles,s=Object(n.useContext)(P),c=s.isAuth,i=s.user.role;return Object(q.jsx)(o.b,{exact:!0,path:a,children:!c||r.length>0&&!r.includes(i)?Object(q.jsx)(o.a,{to:"/"}):t})};E.defaultProps={allowRoles:[]};var W=a(128),Z=a(129),B=function(e){var t=e.user,a=e.children;return Object(q.jsxs)(v.a,{children:[Object(q.jsx)(W.a,{position:"static",children:Object(q.jsxs)(Z.a,{children:[Object(q.jsx)(S.a,{variant:"h6",children:t.username}),Object(q.jsx)(p.a,{component:i.b,color:"inherit",to:"/employee",children:"Employee"})]})}),a]})},J=function(){var e=Object(n.useContext)(P).user;return Object(q.jsx)(B,{user:e,children:Object(q.jsx)(S.a,{component:"h1",variant:"h5",children:"Admin Page"})})},L=function(){var e=Object(n.useContext)(P).user;return Object(q.jsxs)(B,{user:e,children:[Object(q.jsx)(S.a,{component:"h1",variant:"h5",children:"Employee Page"}),e.role===T&&Object(q.jsx)(p.a,{type:"button",variant:"contained",color:"primary",children:"Delete"})]})},I=function(){return Object(q.jsx)(i.a,{basename:".",children:Object(q.jsxs)(o.d,{children:[Object(q.jsx)(o.b,{exact:!0,path:"/",children:Object(q.jsx)(D,{})}),Object(q.jsx)(E,{path:"/admin",allowRoles:[T],children:Object(q.jsx)(J,{})}),Object(q.jsx)(E,{path:"/employee",children:Object(q.jsx)(L,{})})]})})},$=function(e){var t=e.children,a=e.isAuth,r=e.initialRole,s=Object(n.useState)(a),c=Object(h.a)(s,2),i=c[0],o=c[1],l=Object(n.useState)({role:r,username:""}),u=Object(h.a)(l,2),j=u[0],d=u[1],b={isAuth:i,handleSuccessLogin:function(e){var t=e.role,a=e.username;d({role:t,username:a}),o(!0)},user:j};return Object(q.jsx)(P.Provider,{value:b,children:t})};$.defaultProps={isAuth:!1,initialRole:""};var _=function(){return Object(q.jsx)($,{children:Object(q.jsx)(I,{})})};c.a.render(Object(q.jsx)(r.a.StrictMode,{children:Object(q.jsx)(_,{})}),document.getElementById("root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.d93517a5.chunk.js.map